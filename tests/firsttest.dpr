program firsttest;

{$APPTYPE CONSOLE}

uses
  Classes, SysUtils,
  hd_defs, hd_main, hd_form, hd_imgfmt_bmp,
  wglabel, wgbutton;

Const
  dlg_info : Array[0..3125] of byte = (
      66, 77, 54, 12,  0,  0,  0,  0,  0,  0, 54,  0,  0,  0, 40,  0,  0,
       0, 32,  0,  0,  0, 32,  0,  0,  0,  1,  0, 24,  0,  0,  0,  0,  0,
       0, 12,  0,  0,235, 10,  0,  0,235, 10,  0,  0,  0,  0,  0,  0,  0,
       0,  0,  0,209,209,209,209,209,209,209,209,209,209,209,209,209,209,
     209,209,209,209,209,209,209,209,209,209,209,209,209,209,209,209,209,
     209,209,215,215,215,212,212,212,213,203,197,209,193,184,207,189,179,
     207,190,180,210,195,186,213,206,202,218,217,216,209,209,209,209,209,
     209,209,209,209,209,209,209,209,209,209,209,209,209,209,209,209,209,
     209,209,209,209,209,209,209,209,209,209,209,209,209,209,209,209,209,
     209,209,209,209,209,209,209,209,209,209,209,209,209,209,209,209,209,
     209,209,209,209,209,209,209,217,217,217,207,196,189,185,145,123,177,
     121, 90,180,118, 85,189,129, 97,201,145,118,200,143,115,189,127, 95,
     182,124, 93,181,130,101,190,155,135,210,200,194,214,215,215,209,209,
     209,209,209,209,209,209,209,209,209,209,209,209,209,209,209,209,209,
     209,209,209,209,209,209,209,209,209,209,209,209,209,209,209,209,209,
     209,209,209,209,209,209,209,209,209,209,209,209,209,209,209,188,161,
     144,179,130,101,202,152,122,218,169,141,228,180,153,236,191,166,237,
     193,167,238,193,167,238,192,166,236,193,167,235,190,165,227,178,151,
     217,168,138,200,149,119,177,128, 99,201,179,166,209,209,209,209,209,
     209,209,209,209,209,209,209,209,209,209,209,209,209,209,209,209,209,
     209,209,209,209,209,209,209,209,209,209,209,209,209,209,209,209,209,
     209,209,209,210,206,203,187,155,136,182,120, 80,222,172,137,238,191,
     159,230,177,142,225,169,130,224,168,129,224,167,129,224,168,130,224,
     168,130,223,167,129,223,167,128,225,168,130,231,180,144,236,189,156,
     218,165,129,183,123, 83,171,135,113,209,209,209,209,209,209,209,209,
     209,209,209,209,209,209,209,209,209,209,209,209,209,209,209,209,209,
     209,209,209,209,209,209,209,209,209,209,209,214,201,195,164,101, 61,
     211,157,113,230,178,136,219,159,115,216,155,110,218,158,115,220,162,
     120,221,164,122,222,164,124,223,165,124,222,165,124,222,164,123,222,
     163,121,220,162,119,218,159,114,217,155,110,220,160,115,232,179,135,
     194,142,101,183,123, 83,209,209,209,209,209,209,209,209,209,209,209,
     209,209,209,209,209,209,209,209,209,209,209,209,209,209,209,209,209,
     209,209,200,173,158,173,114, 72,218,163,112,218,158,107,212,146, 96,
     213,150,101,215,153,107,216,154,108,206,147,103,201,144,102,202,145,
     104,202,145,104,201,145,104,201,144,102,201,143,101,200,142,100,201,
     143,100,213,151,104,214,150,100,215,147, 96,203,145, 96,203,145, 96,
     183,123, 83,209,209,209,209,209,209,209,209,209,209,209,209,209,209,
     209,209,209,209,209,209,209,209,209,209,213,206,203,171,113, 68,212,
     153, 96,210,143, 87,207,138, 83,210,143, 90,211,145, 93,213,149, 99,
     238,210,190,242,232,225,237,225,216,237,224,214,237,224,214,237,224,
     214,237,223,214,239,229,221,232,217,206,198,145,104,210,144, 93,211,
     145, 93,211,142, 88,195,128, 75,203,145, 96,203,145, 96,183,123, 83,
     209,209,209,209,209,209,209,209,209,209,209,209,209,209,209,209,209,
     209,218,216,214,154, 94, 55,205,144, 80,207,137, 76,204,131, 72,206,
     136, 79,208,139, 83,209,140, 85,210,143, 90,218,162,119,234,203,179,
     255,254,253,255,255,255,255,255,255,255,255,255,255,255,255,243,231,
     221,222,174,137,211,146, 95,210,142, 87,209,140, 84,208,138, 82,197,
     129, 74,178,124, 80,180,131, 87,173,131, 85,143,104, 82,209,209,209,
     209,209,209,209,209,209,209,209,209,209,209,209,187,150,127,190,126,
      58,206,134, 66,200,124, 60,202,129, 67,203,131, 71,205,134, 75,206,
     136, 79,207,137, 82,207,136, 79,205,132, 73,241,220,203,255,255,255,
     255,255,255,255,255,255,251,249,246,194,140, 95,204,132, 75,208,139,
      84,207,138, 81,206,135, 77,205,133, 73,202,129, 69,199,124, 61,196,
     119, 53,203,133, 62,171,105, 44,206,189,180,209,209,209,209,209,209,
     209,209,209,210,207,206,160, 99, 47,205,136, 59,197,118, 49,198,121,
      54,199,125, 59,200,127, 63,202,129, 67,203,131, 70,204,132, 73,204,
     133, 74,203,129, 69,238,215,196,255,255,255,255,255,255,255,255,255,
     248,244,240,187,125, 75,204,133, 74,205,134, 75,204,132, 72,203,131,
      68,202,128, 65,200,125, 61,199,123, 57,197,119, 52,197,119, 49,205,
     138, 57,171,115, 66,221,219,219,209,209,209,209,209,209,171,128,103,
     176,107, 31,196,118, 45,194,114, 43,196,117, 47,197,118, 50,198,121,
      55,200,124, 59,201,126, 62,202,127, 64,202,128, 65,200,124, 60,238,
     214,194,255,255,255,255,255,255,255,255,255,249,244,240,186,123, 70,
     202,127, 65,203,128, 66,202,127, 65,201,126, 61,199,123, 57,198,120,
      53,197,118, 48,195,116, 45,193,112, 42,198,122, 46,177,109, 35,190,
     158,141,209,209,209,215,214,214,168,113, 61,195,123, 36,191,109, 42,
     191,111, 42,193,114, 43,195,114, 44,195,116, 46,197,118, 50,198,120,
      53,199,121, 56,199,122, 58,198,118, 51,237,212,191,255,255,255,255,
     255,255,255,255,255,248,244,239,184,119, 63,198,121, 57,199,123, 58,
     199,121, 56,198,120, 53,196,118, 48,195,115, 46,194,114, 43,193,112,
      42,191,111, 42,191,109, 42,187,115, 34,154, 98, 59,219,218,217,212,
     206,203,169,103, 28,194,119, 36,188,108, 42,190,110, 42,191,112, 43,
     192,113, 43,192,114, 43,194,114, 44,195,115, 45,196,117, 48,196,117,
      49,194,113, 42,236,210,188,255,255,255,255,255,255,255,255,255,248,
     243,239,183,115, 56,195,116, 48,196,118, 49,196,116, 47,195,115, 45,
     193,113, 43,192,112, 43,191,111, 42,190,110, 42,189,109, 42,187,106,
      42,192,115, 34,156, 92, 29,213,206,204,184,154,136,171, 99, 15,189,
     110, 38,186,106, 43,187,108, 42,189,109, 43,190,110, 43,191,111, 43,
     191,112, 43,192,113, 43,193,114, 44,193,114, 43,191,107, 33,235,208,
     185,255,255,255,255,255,255,255,255,255,248,243,239,181,111, 49,192,
     112, 40,194,113, 43,193,113, 43,192,111, 42,191,111, 42,190,110, 42,
     189,109, 42,188,107, 42,186,106, 41,185,104, 42,189,111, 35,169, 98,
      19,205,185,174,163,120, 93,172, 97, 17,185,105, 40,184,104, 41,185,
     105, 41,186,107, 42,187,108, 42,188,109, 42,189,109, 42,189,110, 42,
     190,111, 43,190,111, 42,188,105, 33,234,208,185,255,255,255,255,255,
     255,255,255,255,248,243,238,180,109, 47,190,109, 39,191,110, 42,190,
     110, 42,189,109, 42,189,108, 42,188,107, 41,187,106, 41,186,105, 41,
     184,104, 41,183,102, 40,185,105, 38,177,103, 16,198,170,152,157,108,
      75,176,101, 27,185,107, 50,185,108, 49,187,109, 49,187,111, 49,188,
     111, 50,189,112, 50,189,113, 50,190,113, 50,191,114, 50,191,114, 49,
     189,108, 41,234,208,187,255,255,255,255,255,255,255,255,255,248,243,
     238,178,107, 47,187,106, 38,189,108, 42,188,107, 41,187,106, 41,185,
     106, 41,185,105, 41,184,103, 41,183,103, 40,182,102, 40,181,100, 39,
     183,102, 38,179,103, 20,189,158,135,153,103, 70,179,108, 41,189,116,
      65,188,117, 64,190,118, 64,191,118, 64,191,119, 63,192,119, 64,193,
     120, 65,193,121, 65,194,122, 65,193,121, 63,190,112, 50,235,210,190,
     255,255,255,255,255,255,255,255,255,248,242,238,176,104, 45,185,103,
      37,186,106, 41,186,105, 41,185,105, 41,184,104, 40,183,102, 40,182,
     102, 40,181,101, 40,180, 99, 39,179, 98, 39,181,100, 38,178,102, 23,
     185,152,130,154,106, 76,179,109, 48,193,127, 80,191,125, 77,192,126,
      77,193,127, 77,193,127, 77,194,128, 78,195,129, 78,195,129, 78,195,
     128, 76,192,121, 67,210,162,123,250,245,240,255,255,255,255,255,255,
     255,255,255,249,245,241,180,114, 62,182, 99, 34,182,101, 37,183,102,
      40,182,102, 40,182,101, 40,180,100, 40,180, 99, 39,179, 99, 39,178,
      97, 39,176, 95, 39,179, 98, 38,177,100, 26,190,160,140,164,123, 98,
     175,108, 52,198,138, 95,194,134, 91,195,135, 91,196,136, 91,197,136,
      92,197,137, 92,198,138, 92,197,136, 89,205,149,108,236,216,200,253,
     251,250,255,255,255,255,255,255,255,255,255,255,255,255,250,247,244,
     191,137, 94,192,125, 73,186,110, 53,180,100, 39,179, 97, 37,179, 99,
      38,178, 98, 39,177, 97, 39,176, 96, 39,175, 95, 38,174, 93, 38,178,
      98, 38,172, 96, 28,200,182,171,195,170,154,171,104, 51,205,150,109,
     198,142,105,199,143,106,199,144,106,201,145,106,201,145,106,201,146,
     106,201,144,103,207,158,122,230,203,184,233,209,192,234,214,198,239,
     222,209,242,228,218,247,237,230,244,231,222,203,150,110,202,147,106,
     203,147,107,197,134, 90,182,105, 51,176, 95, 37,174, 92, 33,174, 92,
      35,174, 93, 37,174, 93, 37,172, 91, 37,180, 99, 39,160, 88, 33,205,
     193,187,214,211,210,163, 98, 50,208,153,111,202,153,121,203,154,120,
     204,154,120,204,154,120,204,155,120,205,155,120,205,155,121,204,154,
     118,202,148,109,203,150,113,204,153,115,205,154,116,206,155,119,208,
     158,122,208,159,124,206,157,121,206,156,121,206,156,121,206,158,123,
     204,154,119,198,142,102,190,126, 81,177,100, 49,170, 88, 33,169, 86,
      30,167, 85, 31,178, 97, 39,143, 80, 38,209,209,209,209,209,209,156,
     102, 66,195,132, 88,209,167,139,207,163,133,208,163,134,208,163,134,
     209,164,134,209,165,134,209,165,134,209,165,134,210,165,134,210,165,
     133,208,163,130,211,167,137,210,168,139,204,159,127,206,161,129,210,
     166,135,210,166,134,210,165,134,209,165,134,209,165,135,210,167,138,
     211,167,139,207,161,130,195,137,100,185,119, 77,180,109, 64,171, 93,
      38,159,123, 99,209,209,209,209,209,209,170,137,117,158, 90, 46,218,
     179,153,212,172,149,212,172,148,212,173,148,213,172,148,213,174,148,
     213,174,148,214,174,148,214,174,148,213,171,143,225,197,177,246,240,
     235,249,246,243,232,215,204,203,165,140,208,169,142,215,174,149,214,
     174,148,213,174,148,213,174,148,213,173,148,212,172,147,213,174,149,
     214,176,152,214,177,155,214,164,132,160, 87, 39,205,198,194,209,209,
     209,209,209,209,216,214,213,161,117, 90,208,154,120,220,188,169,216,
     182,161,217,183,161,217,183,162,217,183,162,218,183,162,218,183,162,
     217,181,158,230,206,191,254,252,252,255,255,255,255,255,255,255,255,
     255,237,224,216,209,176,153,218,184,162,218,184,162,218,183,162,218,
     183,162,217,183,162,217,183,162,217,182,161,217,183,163,219,183,162,
     186,112, 66,152,100, 69,209,209,209,209,209,209,209,209,209,209,209,
     209,192,167,151,156, 85, 40,223,187,165,224,196,181,222,193,176,222,
     193,176,223,193,176,223,193,176,223,193,176,222,190,172,242,229,221,
     255,255,255,255,255,255,255,255,255,255,255,255,253,251,250,219,193,
     177,222,192,174,223,193,176,223,193,176,223,193,176,223,193,176,222,
     193,176,222,193,176,226,200,185,210,159,127,136, 65, 21,189,167,154,
     209,209,209,209,209,209,209,209,209,209,209,209,209,209,209,139, 91,
      62,182,121, 82,236,212,197,228,206,192,228,204,190,228,204,190,228,
     204,190,228,204,190,227,202,187,240,227,220,255,255,255,255,255,255,
     255,255,255,255,255,255,248,244,241,224,201,187,228,203,189,228,204,
     190,228,204,190,228,204,190,228,204,190,228,204,190,232,212,201,225,
     185,159,157, 82, 35,169,138,119,209,209,209,209,209,209,209,209,209,
     209,209,209,209,209,209,209,209,209,218,217,215,156,112, 84,183,124,
      86,243,225,214,237,221,213,233,216,204,233,216,205,233,216,205,233,
     215,204,234,217,207,245,237,233,255,254,254,255,255,255,251,247,246,
     236,221,212,233,214,203,233,216,205,233,216,205,233,216,205,233,216,
     205,233,216,206,238,225,217,232,199,178,157, 85, 39,153,110, 83,209,
     209,209,209,209,209,209,209,209,209,209,209,209,209,209,209,209,209,
     209,209,209,209,209,209,211,206,202,142, 86, 52,186,129, 93,236,212,
     196,244,237,231,241,229,222,240,227,219,240,227,219,239,226,218,240,
     225,217,243,233,226,244,235,229,241,229,221,239,226,218,240,227,220,
     240,227,219,240,227,219,240,227,220,241,230,224,244,233,227,227,193,
     171,163, 89, 43,151,105, 77,216,215,214,209,209,209,209,209,209,209,
     209,209,209,209,209,209,209,209,209,209,209,209,209,209,209,209,209,
     209,209,209,219,217,216,135, 86, 55,150, 81, 38,225,189,166,251,243,
     239,252,247,245,249,242,239,247,239,235,247,238,234,246,237,232,246,
     237,232,247,238,233,247,238,234,247,238,234,247,239,235,250,245,243,
     252,248,246,250,240,233,207,152,118,143, 69, 23,156,120, 97,209,209,
     209,209,209,209,209,209,209,209,209,209,209,209,209,209,209,209,209,
     209,209,209,209,209,209,209,209,209,209,209,209,209,209,209,209,209,
     209,209,209,196,174,159,139, 81, 45,166,108, 71,217,174,146,249,235,
     226,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,
     255,255,255,255,255,255,254,253,241,217,202,206,157,125,152, 88, 48,
     149, 97, 64,204,195,188,209,209,209,209,209,209,209,209,209,209,209,
     209,209,209,209,209,209,209,209,209,209,209,209,209,209,209,209,209,
     209,209,209,209,209,209,209,209,209,209,209,209,209,209,209,209,209,
     224,222,221,169,137,117,150, 95, 61,160, 96, 54,181,133,101,205,168,
     146,217,186,166,223,195,177,223,193,174,215,182,161,200,162,136,173,
     117, 81,156, 90, 48,150, 97, 64,171,144,126,217,217,217,209,209,209,
     209,209,209,209,209,209,209,209,209,209,209,209,209,209,209,209,209,
     209,209,209,209,209,209,209,209,209,209,209,209,209,209,209,209,209,
     209,209,209,209,209,209,209,209,209,209,209,209,209,209,209,209,209,
     209,209,209,216,211,208,183,156,140,148,104, 77,124, 73, 40,130, 76,
      43,128, 74, 41,129, 78, 47,150,107, 81,184,156,139,218,214,211,209,
     209,209,209,209,209,209,209,209,209,209,209,209,209,209,209,209,209,
     209,209,209,209,209,209,209,209,209,209,209,209,209,209,209);

type

  { TmyForm }

  TmyForm = class(TpgfForm)
  public
    img : TpgfImage;
    img2 : TpgfImage;

    label1 : TwgLabel;

    txtTime : TwgLabel;
    txtTime2 : TwgLabel;

    btn : TwgButton;
    btn2 : TwgButton;

    timer : TpgfTimer;
    timer2 : TpgfTimer;

    cnt : integer;

    procedure AfterCreate; override;

    procedure HandlePaint; override;

    procedure MyOnTimer(sender : TObject);
    procedure MyOnTimer2(sender : TObject);
  end;

{ TmyForm }

procedure TmyForm.HandlePaint;
begin
  Canvas.BeginDraw;

  inherited HandlePaint;

  canvas.SetColor(0);

  canvas.DrawString(10,10,'Hello from PasGF');

  Canvas.SetColor($FF0000);

  canvas.DrawLine(10,40,200,45);
  canvas.DrawRectangle(10,60,200,20);
  canvas.FillRectangle(10,90,200,20);

  canvas.DrawImage(20,75, img);
  canvas.DrawImage(70,75, img2);

  canvas.DrawButtonFace(10,160,100,25);

  canvas.DrawControlFrame(10,190,100,25);

  Canvas.EndDraw(0,0, Width, Height);
end;

procedure TmyForm.MyOnTimer(sender: TObject);
begin
  //Writeln('OnTimer callback!');
  txtTime.Text := FormatDateTime('hh:nn:ss.zzz',now);
end;

procedure TmyForm.MyOnTimer2(sender: TObject);
begin
  inc(cnt);
  txtTime2.text := IntToStr(cnt);
end;


procedure TmyForm.AfterCreate;
begin
  SetPosition(100,100,300,300);

  //Sizeable := false;
  MinWidth  := 200;
  MinHeight := 150;
  Caption := 'valami';

  img := CreateImage_BMP(@dlg_info, sizeof(dlg_info));
  img2 := CreateImage_BMP(@dlg_info, sizeof(dlg_info));
  img2.CreateMaskFromSample(0,0);
  img2.UpdateImage;

  label1 := CreateLabel(self, 10, 220, 'Label test');
  label1.BackgroundColor := $FFFFFF;

  btn := CreateButton(self, 10, 240, 90, 'Button', nil);
  btn.Anchors := [anLeft, anRight, anBottom];
  btn2 := CreateButton(self, 10, 270, 90, 'Button2', nil);
  btn2.Anchors := [anRight, anBottom];

  txtTime := CreateLabel(self,150,200,'xxx');
  txtTime.FontDesc := 'Times New Roman-14:bold';
  txtTime.Width := 150;
  txtTime.Height := txtTime.Font.Height;

  txtTime2 := CreateLabel(self,150,240,'xxx');
  txtTime2.FontDesc := 'Courier-12';
  txtTime2.Width := 100;
  txtTime2.Height := txtTime.Font.Height;

  timer := TpgfTimer.Create(20);
  timer.OnTimer := MyOnTimer;
  timer.Enabled := true;

  cnt := 0;
  timer2 := TpgfTimer.Create(50);
  timer2.OnTimer := MyOnTimer2;
  timer2.Enabled := true;
end;

procedure MainProc;
var
  frm : TmyForm;
begin
  Writeln('PGF test...');
  pgfOpenDisplay('');
  frm := TmyForm.Create(nil);
  frm.Show;
  pgfRunMessageLoop;
end;

begin
  MainProc;
end.


